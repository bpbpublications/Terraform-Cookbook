// file: policies/s3-versioning-required.sentinel

import "tfplan"

main = rule {
  all tfplan.resources.aws_s3_bucket as _, buckets {
    all buckets as _, b {
      // Require versioning to be explicitly enabled
      b.applied.versioning is not null and
      length(b.applied.versioning) > 0 and
      (b.applied.versioning[0].enabled else false)
    }
  }
}